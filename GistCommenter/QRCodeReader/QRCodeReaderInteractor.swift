//
//  QRCodeReaderInteractor.swift
//  GistCommenter
//
//  Created Bruno Gama on 21/03/2018.
//  Copyright © 2018 Bruno Gama. All rights reserved.
//
//  Template generated by Juanpe Catalán @JuanpeCMiOS
//

import AVFoundation
import UIKit

internal class QRCodeReaderInteractor: NSObject,
                                       QRCodeReaderInteractorInputProtocol,
                                       AVCaptureMetadataOutputObjectsDelegate {

    weak var presenter: QRCodeReaderInteractorOutputProtocol?

    // MARK: - QRCodeReaderInteractorInputProtocol
    func received(metadata: AVMetadataMachineReadableCodeObject?) {
        presenter?.received(metadata: metadata)
    }

    // MARK: - AVCaptureMetadataOutputObjectsDelegate
    func metadataOutput(_ output: AVCaptureMetadataOutput,
                        didOutput metadataObjects: [AVMetadataObject],
                        from connection: AVCaptureConnection) {

        if let redableObject = metadataObjects.first as? AVMetadataMachineReadableCodeObject {
            received(metadata: redableObject)
        }
        else {
            received(metadata: nil)
        }

    }
}
